<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A Special Question</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
  :root {
    --primary: #ff3b6f;
    --bg-grad: linear-gradient(135deg, #ffd6e0 0%, #c8f7ff 100%);
    --glass: rgba(255, 255, 255, 0.4);
  }

  * {
    font-family: "Times New Roman", Times, serif !important;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  body {
    margin: 0;
    height: 100dvh;
    width: 100vw;
    background: var(--bg-grad);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    position: fixed;
  }

  /* Main Container */
  .box {
    text-align: center;
    padding: 30px 20px;
    width: 85%;
    max-width: 350px;
    background: var(--glass);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 30px;
    border: 1px solid rgba(255,255,255,0.5);
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    z-index: 10;
  }

  /* Dedicated GIF Area to prevent overlapping */
  .gif-stage {
    width: 100%;
    min-height: 160px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 15px;
  }

  .tenor-gif-embed {
    width: 150px !important;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }

  h1 {
    font-size: 1.8rem;
    color: var(--primary);
    margin: 10px 0;
    line-height: 1.2;
    text-shadow: 1px 1px 0px white;
  }

  p {
    font-size: 1.1rem;
    color: #666;
    margin-bottom: 25px;
  }

  /* Button Logic */
  .btn-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-top: 20px;
    position: relative;
    min-height: 60px;
  }

  button {
    padding: 15px 30px;
    font-size: 16px;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    background: var(--primary);
    color: white;
    font-weight: bold;
    box-shadow: 0 5px 15px rgba(255, 59, 111, 0.3);
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 11;
  }

  #no {
    background: #888;
    position: fixed; /* Fixed to viewport to stay visible */
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    z-index: 12;
  }

  .hidden { display: none !important; }

  /* Hearts Animation */
  .heart {
    position: absolute;
    pointer-events: none;
    z-index: 1;
    animation: floatUp 4s linear forwards;
  }

  @keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-110dvh) scale(1.5); opacity: 0; }
  }
</style>
</head>
<body>

  <div class="box" id="intro">
    <div class="gif-stage">
      <div class="tenor-gif-embed" data-postid="22532913" data-share-method="host" data-aspect-ratio="1.77778" data-width="100%"></div>
    </div>
    <h1>Heyâ€¦ ğŸ¥º</h1>
    <p>I need to ask you something very important ğŸ’—</p>
    <button id="start">Okay ğŸ«¶</button>
  </div>

  <div class="box hidden" id="questionBox">
    <div class="gif-stage">
      <div id="g-knife" class="tenor-gif-embed hidden" data-postid="6447555532574214775" data-share-method="host" data-aspect-ratio="1" data-width="100%"></div>
      <div id="g-shake" class="tenor-gif-embed hidden" data-postid="12413317499980731043" data-share-method="host" data-aspect-ratio="1.29016" data-width="100%"></div>
      <div id="g-break" class="tenor-gif-embed hidden" data-postid="12177904528014688220" data-share-method="host" data-aspect-ratio="1.04018" data-width="100%"></div>
    </div>
    
    <h1 id="question">Do you love me? ğŸ’–</h1>
    
    <div class="btn-wrapper">
      <button id="yes">Yes ğŸ’•</button>
      <button id="no">No ğŸ™„</button>
    </div>
  </div>

  <div class="box hidden" id="celebration">
    <div class="gif-stage">
      <div class="tenor-gif-embed" data-postid="11975191960342404712" data-share-method="host" data-aspect-ratio="1.10667" data-width="100%"></div>
    </div>
    <h1>YAYYYY ğŸ’–ğŸ‰</h1>
    <p>I knew it ğŸ˜Œ</p>
    <p>Screenshot this & send it to me ğŸ˜ğŸ“¸</p>
  </div>

  <script type="text/javascript" async src="https://tenor.com/embed.js"></script>

  <script>
    const startBtn = document.getElementById("start");
    const intro = document.getElementById("intro");
    const questionBox = document.getElementById("questionBox");
    const celebration = document.getElementById("celebration");
    const noBtn = document.getElementById("no");
    const yesBtn = document.getElementById("yes");
    const questionText = document.getElementById("question");

    const gKnife = document.getElementById("g-knife");
    const gShake = document.getElementById("g-shake");
    const gBreak = document.getElementById("g-break");

    const msgs = ["Are you sure? ğŸ˜³", "Think carefullyâ€¦ ğŸ¥º", "My heart is watching ğŸ’”", "Stop joking now ğŸ˜­", "No is unavailable âŒ"];
    let count = 0;

    // Trigger vibration helper
    function shakePhone() {
      if (navigator.vibrate) {
        navigator.vibrate([50, 30, 50]);
      }
    }

    startBtn.onclick = () => {
      shakePhone();
      intro.classList.add("hidden");
      questionBox.classList.remove("hidden");
      // Pre-position No button
      const rect = noBtn.getBoundingClientRect();
      noBtn.style.top = rect.top + "px";
      noBtn.style.left = rect.left + "px";
    };

    function moveNo() {
      shakePhone();
      questionText.textContent = msgs[Math.min(count, msgs.length - 1)];
      
      // GIF Logic
      if (count === 0) { gKnife.classList.remove("hidden"); }
      if (count === 1) { gKnife.classList.add("hidden"); gShake.classList.remove("hidden"); }
      if (count === 3) { gShake.classList.add("hidden"); gBreak.classList.remove("hidden"); }

      count++;

      // iOS Safe Movement Logic
      const padding = 50;
      const safeZone = yesBtn.getBoundingClientRect();
      
      let newX, newY;
      
      // Avoid spawning No button on top of Yes button
      do {
        newX = Math.random() * (window.innerWidth - padding * 2) + padding;
        newY = Math.random() * (window.innerHeight - padding * 2) + padding;
      } while (
        newX > safeZone.left - 50 && 
        newX < safeZone.right + 50 && 
        newY > safeZone.top - 50 && 
        newY < safeZone.bottom + 50
      );

      noBtn.style.left = newX + "px";
      noBtn.style.top = newY + "px";

      // Scale Yes button
      const scale = Math.min(1 + count * 0.2, 2.0);
      yesBtn.style.transform = `scale(${scale})`;

      if (count > 6) noBtn.style.display = "none";
    }

    noBtn.addEventListener('touchstart', (e) => {
      e.preventDefault();
      moveNo();
    });
    noBtn.onmouseover = moveNo;

    yesBtn.onclick = () => {
      shakePhone();
      questionBox.classList.add("hidden");
      celebration.classList.remove("hidden");
      
      // Heart rain
      setInterval(() => {
        const h = document.createElement("div");
        h.className = "heart";
        h.innerHTML = "ğŸ’–";
        h.style.left = Math.random() * 100 + "vw";
        h.style.bottom = "-20px";
        h.style.fontSize = Math.random() * 20 + 20 + "px";
        document.body.appendChild(h);
        setTimeout(() => h.remove(), 4000);
      }, 200);
    };
  </script>
</body>
</html>
