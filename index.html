<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Secured Message</title>

<style>
  /* --- iOS SYSTEM VARIABLES --- */
  :root {
    --primary: #FF2D55; /* Apple Pink */
    --secondary: #E5E5EA; /* Apple Gray */
    --text-main: #000000;
    --text-sub: #8E8E93;
    --input-bg: #F2F2F7;
    --error: #FF3B30;
  }

  * {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    user-select: none;
  }

  body {
    margin: 0;
    width: 100vw;
    height: 100dvh;
    background-color: #F2F2F7;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    position: fixed;
  }

  /* --- ANIMATED MESH GRADIENT --- */
  .mesh-bg {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(at 0% 0%, hsla(340,100%,85%,1) 0, transparent 50%), 
                radial-gradient(at 100% 100%, hsla(240,100%,85%,1) 0, transparent 50%),
                radial-gradient(at 100% 0%, hsla(180,100%,85%,1) 0, transparent 50%);
    z-index: -1;
    filter: blur(50px);
    opacity: 0.7;
    animation: pulse 10s ease infinite alternate;
  }

  @keyframes pulse {
    0% { transform: scale(1); opacity: 0.7; }
    100% { transform: scale(1.1); opacity: 0.5; }
  }

  /* --- GLASS CARD (iOS Style) --- */
  .card {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(30px) saturate(180%);
    -webkit-backdrop-filter: blur(30px) saturate(180%);
    border-radius: 32px;
    width: 88%;
    max-width: 380px;
    padding: 36px 28px;
    text-align: center;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.6);
    padding-bottom: max(36px, env(safe-area-inset-bottom));
    transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
    z-index: 10;
  }

  .media-container {
    width: 100%;
    height: 180px;
    background: rgba(255,255,255,0.5);
    border-radius: 24px;
    margin-bottom: 24px;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.02);
  }

  .tenor-gif-embed {
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: none;
  }

  h1 {
    font-size: 26px;
    font-weight: 800;
    color: var(--text-main);
    margin: 0 0 10px 0;
    letter-spacing: -0.02em;
  }

  p {
    font-size: 17px;
    color: var(--text-sub);
    margin: 0 0 32px 0;
    line-height: 1.5;
  }

  /* --- INPUT FIELD --- */
  input[type="text"] {
    width: 100%;
    padding: 16px;
    border-radius: 16px;
    border: none;
    background: var(--input-bg);
    font-size: 17px; /* Matches iOS default */
    color: var(--text-main);
    margin-bottom: 16px;
    text-align: center;
    outline: none;
    transition: background 0.2s;
    user-select: text;
    -webkit-user-select: text;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
  }

  input:focus {
    background: #fff;
    box-shadow: 0 0 0 2px var(--primary);
  }

  .error-shake {
    animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
    border: 1px solid var(--error) !important;
  }

  /* --- BUTTONS --- */
  .actions {
    display: flex;
    gap: 12px;
    width: 100%;
    position: relative;
  }

  button {
    width: 100%;
    padding: 18px 0;
    border-radius: 18px;
    font-size: 17px;
    font-weight: 700;
    border: none;
    cursor: pointer;
    transition: transform 0.2s, opacity 0.2s;
    -webkit-appearance: none; /* iOS Reset */
  }

  .btn-primary {
    background: var(--primary);
    color: white;
    box-shadow: 0 8px 20px rgba(255, 45, 85, 0.25);
  }
  
  .btn-primary:active { transform: scale(0.96); }

  .btn-secondary {
    background: var(--secondary);
    color: #000;
    position: relative;
    z-index: 100;
    transition: top 0.3s, left 0.3s; 
  }

  .btn-locked {
    opacity: 1; 
  }

  /* Flying NO button */
  .btn-secondary.flying {
    position: fixed;
    width: auto;
    padding: 14px 30px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    z-index: 1000;
  }

  /* --- UTILITIES --- */
  .hidden { display: none !important; opacity: 0; pointer-events: none; }
  
  @keyframes shake {
    10%, 90% { transform: translate3d(-1px, 0, 0); }
    20%, 80% { transform: translate3d(2px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
    40%, 60% { transform: translate3d(4px, 0, 0); }
  }

  .heart {
    position: absolute;
    font-size: 24px;
    pointer-events: none;
    animation: float 3s ease-in forwards;
  }

  @keyframes float {
    0% { transform: translateY(0) scale(0.5); opacity: 0; }
    20% { opacity: 1; transform: translateY(-20px) scale(1.2); }
    100% { transform: translateY(-100vh) scale(1); opacity: 0; }
  }
</style>
</head>
<body>

  <div class="mesh-bg"></div>

  <div class="card" id="intro-view">
    <div class="media-container">
      <div class="tenor-gif-embed" data-postid="22532913" data-share-method="host" data-aspect-ratio="1.77778" data-width="100%"></div>
    </div>
    <h1>Hey... ðŸ¥º</h1>
    <p>I have a very important question for you.</p>
    <button class="btn-primary" onclick="goToPass()">Open Message ðŸ’Œ</button>
  </div>

  <div class="card hidden" id="pass-view">
    <div style="font-size: 50px; margin-bottom: 20px;">ðŸ”’</div>
    <h1>Security Check</h1>
    <p>This message is locked. To open it, answer this:</p>
    <p style="color: #000; font-weight: 600; margin-bottom: 15px;">What is my favorite bike?</p>
    
    <input type="text" id="pass-input" placeholder="Type here..." autocomplete="off">
    <button class="btn-primary" onclick="checkPass()">Unlock Message</button>
  </div>

  <div class="card hidden" id="question-view">
    <div class="media-container">
      <div id="g1" class="tenor-gif-embed hidden" data-postid="6447555532574214775" data-share-method="host" data-aspect-ratio="1" data-width="100%"></div>
      <div id="g2" class="tenor-gif-embed hidden" data-postid="12413317499980731043" data-share-method="host" data-aspect-ratio="1.29016" data-width="100%"></div>
      <div id="g3" class="tenor-gif-embed hidden" data-postid="12177904528014688220" data-share-method="host" data-aspect-ratio="1.04018" data-width="100%"></div>
    </div>
    
    <h1 id="title-text">Do you love me? ðŸ’–</h1>
    <p id="desc-text">Be honest...</p>

    <div class="actions">
      <button class="btn-primary" id="yes-btn" onclick="goToSuccess()">Yes</button>
      <button class="btn-secondary btn-locked" id="no-btn">No</button>
    </div>
  </div>

  <div class="card hidden" id="success-view">
    <div class="media-container">
      <div class="tenor-gif-embed" data-postid="11975191960342404712" data-share-method="host" data-aspect-ratio="1.10667" data-width="100%"></div>
    </div>
    <h1>Yay! ðŸ’–</h1>
    <p>I knew it! Screenshot this & send it to me! ðŸ“¸</p>
  </div>

  <script type="text/javascript" async src="https://tenor.com/embed.js"></script>

  <script>
    // --- ELEMENTS ---
    const views = {
      intro: document.getElementById('intro-view'),
      pass: document.getElementById('pass-view'),
      question: document.getElementById('question-view'),
      success: document.getElementById('success-view')
    };
    
    const passInput = document.getElementById('pass-input');
    const texts = { title: document.getElementById('title-text'), desc: document.getElementById('desc-text') };
    const btns = { yes: document.getElementById('yes-btn'), no: document.getElementById('no-btn') };
    const gifs = { g1: document.getElementById('g1'), g2: document.getElementById('g2'), g3: document.getElementById('g3') };

    let stage = 0;
    const messages = ["Are you sure? ðŸ˜³", "Think again... ðŸ¥º", "Last chance ðŸ’”", "Don't do this ðŸ˜­"];

    // --- NAVIGATION ---
    
    // 1. Intro -> Password
    function goToPass() {
      views.intro.classList.add('hidden');
      views.pass.classList.remove('hidden');
      // Small delay to allow CSS transition before focusing
      setTimeout(() => passInput.focus(), 100);
    }

    // 2. Password -> Question
    function checkPass() {
      const answer = passInput.value.trim().toLowerCase();
      
      if (answer === "h2r") {
        passInput.blur(); 
        views.pass.classList.add('hidden');
        views.question.classList.remove('hidden');
        
        // Show the first GIF (Knife)
        gifs.g1.classList.remove('hidden');

        // BUG FIX: 1-second lock on NO button to prevent accidental clicks
        setTimeout(() => {
          btns.no.classList.remove('btn-locked');
        }, 1000);

      } else {
        views.pass.classList.add('error-shake');
        passInput.style.border = "1px solid #FF3B30";
        if(navigator.vibrate) navigator.vibrate(200);
        
        setTimeout(() => {
          views.pass.classList.remove('error-shake');
          passInput.style.border = "none";
        }, 500);
      }
    }

    passInput.addEventListener("keypress", function(event) {
      if (event.key === "Enter") checkPass();
    });

    // 3. Question Logic
    function handleNo(e) {
      // Prevent "Ghost Clicks" if button is locked
      if (btns.no.classList.contains('btn-locked')) return;
      if(e.type === 'touchstart') e.preventDefault();

      // Shake the card (Visual Haptic)
      views.question.classList.remove('error-shake');
      void views.question.offsetWidth;
      views.question.classList.add('error-shake');
      if (navigator.vibrate) navigator.vibrate(50);

      // Update Text
      texts.title.innerText = messages[Math.min(stage, messages.length - 1)];
      texts.desc.innerText = "Wrong button! ðŸ™„";

      // --- GIF STAGE LOGIC (Matches your 3 GIFs) ---
      // Stage 0 (Default): Knife (g1) is already visible
      // Click 1 -> Stage 1: Show Shake (g2)
      if (stage === 0) { 
        gifs.g1.classList.add('hidden'); 
        gifs.g2.classList.remove('hidden'); 
      }
      // Click 2 -> Stage 2: Show Cry (g3)
      if (stage === 1) { 
        gifs.g2.classList.add('hidden'); 
        gifs.g3.classList.remove('hidden'); 
      }

      stage++;

      // Make No button float away
      btns.no.classList.add('flying');
      
      const padding = 20;
      const yesRect = btns.yes.getBoundingClientRect();
      const maxX = window.innerWidth - 100;
      const maxY = window.innerHeight - 60;
      
      let x, y;

      // Try to find a spot that doesn't overlap YES button
      for(let i=0; i<50; i++) {
        x = Math.random() * maxX + 20;
        y = Math.random() * maxY + 20;

        if (
          x < yesRect.right + 30 && 
          x + 80 > yesRect.left - 30 && 
          y < yesRect.bottom + 30 && 
          y + 50 > yesRect.top - 30
        ) continue;
        
        break;
      }

      btns.no.style.left = x + 'px';
      btns.no.style.top = y + 'px';

      // Grow Yes Button
      const scale = 1 + (stage * 0.2);
      btns.yes.style.transform = `scale(${scale})`;
      
      // Hide No button after 5 attempts
      if (stage > 5) btns.no.style.display = 'none';
    }

    btns.no.addEventListener('touchstart', handleNo);
    btns.no.addEventListener('mouseover', handleNo);
    btns.no.addEventListener('click', handleNo);

    // 4. Success
    function goToSuccess() {
      views.question.classList.add('hidden');
      views.success.classList.remove('hidden');
      createHearts();
    }

    function createHearts() {
      setInterval(() => {
        const heart = document.createElement('div');
        heart.innerHTML = 'ðŸ’–';
        heart.classList.add('heart');
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.bottom = '-50px';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 3000);
      }, 150);
    }
  </script>
</body>
</html>
